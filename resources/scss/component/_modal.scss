/* 모달 */
//사이즈 정의
@mixin modal-size-variable() {
	--upl-modal--size-large: 76rem;
	--upl-modal--size-medium: 56rem;
	--upl-modal--size-small: 40rem;
	--upl-modal--size-min-height: 26.4rem;
	--upl-modal--wrap-radius: var(--upl-radius-xlarge1);
	--upl-modal--padding: var(--upl-padding-10);
	--upl-modal--header-padding-top: var(--upl-number-17);
	--upl-modal--header-pc-font-size: var(--upl-pc-font-size-heading-medium);
	--upl-modal--header-mobile-font-size: var(--upl-mobile-font-size-heading-medium);
	--upl-modal--conts-padding-top: var(--upl-padding-6);
	--upl-modal--conts-padding-bottom: var(--upl-padding-3);
	--upl-modal--conts-gap: var(--upl-gap-5);
	--upl-modal--btn-gap: var(--upl-gap-3);
	--upl-modal--btn-padding-top: var(--upl-padding-6);
	--upl-modal--btn-size-min-wdith: 7.8rem;
	--upl-modal--btn-close-position: var(--upl-gap-7);
	
	//mobile
	--upl-modal--mobile-gap: var(--upl-gap-7);
	--upl-modal--mobile-width: calc(100% - var(--upl-gap-7));
	--upl-modal--mobile-height: calc(100% - var(--upl-modal--mobile-gap) * 2);
	--upl-modal--mobile-padding: var(--upl-padding-8); 
	--upl-modal--mobile-header-padding-top: 5.2rem;
	--upl-modal--mobile-btn-close-position: var(--upl-gap-6);
	--upl-modal--mobile-btn-padding-top: var(--upl-padding-6);
	--upl-modal--mobile-btn-padding-bottom: var(--upl-padding-8);
}

//컬러 정의
@mixin modal-color-variable($mode: light) {
	--upl-modal--border-width: var(--upl-#{$mode}-border-width-variable-regular);
	--upl-modal--color-text: var(--upl-#{$mode}-color-text-basic);
	--upl-modal--wrap-color-surface: var(--upl-#{$mode}-color-surface-white-subtler);
	--upl-modal--wrap-color-border: var(--upl-#{$mode}-color-border-gray);
	--upl-modal--wrap-shadow: 0 0 0.2rem 0 var(--upl-#{$mode}-color-alpha-shadow2), 0 1.6rem 2.4rem 0 var(--upl-#{$mode}-color-alpha-shadow3);
	--upl-modal--color-dim: var(--upl-#{$mode}-color-background-dim);
	--upl-modal--full-popup-surface: var(--upl-#{$mode}-color-surface-secondary-subtler);
}

//modal size
$modal-size: (
		sm: var(--upl-modal--size-small),
		md: var(--upl-modal--size-medium),
		lg: var(--upl-modal--size-large),
) !default;


//modal default css
@mixin modal-default {
	display: none;
	position: fixed;
	top: 0;
	right: 0;
	bottom: 0;
	left: 0;
	z-index: -1;
	visibility: hidden;
	width: 100%;
	height: 100%;
	opacity: 0;
	transition: visibility .15s .3s, z-index 0s .3s, opacity .2s;
}

//모드 설정
$mode-setting: light;
.upl-modal {
	@include modal-size-variable();
	@include modal-color-variable(#{$mode-setting});

	@include modal-default();
	@include reset-text();

	> * {
		width: 100%;
	}
	&.in {
		z-index: 1010;
		transition-delay: 0s;
		opacity: 1; 
		visibility: visible;
	}
	&.shown {
		display: block;
	}

	//dim-backgorund
	.modal-back {
		position: fixed;
		top: 0;
		right: 0;
		bottom: 0;
		left: 0;
		visibility: hidden;
		z-index: -1;
		background-color: var(--upl-modal--color-dim);
		&.in {
			display: block;
			z-index: 1000;
			visibility: visible;
		}
	}

	//기본타입  
	.modal-dialog {
		@include flex-layout($ai: center);
		position: relative;
		z-index: 1020;
		width:var(--upl-modal--size-large); // size클래스 없을 경우. 기본 large 84.6rem;
		height: 100%;
		min-height: var(--upl-modal--size-min-height);
		margin:0 auto;
		
		//modal size
		@each $size, $value in $modal-size {
			&.modal-#{$size} {
				max-width: $value;
			}
		}
		.modal-content {  
			@include flex-layout($ai: center, $fd: column);
			position: relative;
			width: 100%;
			max-height: 80%;
			background-color: var(--upl-modal--wrap-color-surface);
			border-radius: var(--upl-modal--wrap-radius);
			border:var(--upl-modal--border-width) solid var(--upl-modal--wrap-color-border);
			color: var(--upl-modal--color-text);
			outline-color: transparent;
			transition: outline-color .1s;
			box-shadow: var(--upl-modal--wrap-shadow);
			
			> *:not(.btn-close) {
				width: 100%;
			}
			&:focus {
				@include focus($offset: .4rem, $color: var(--upl-modal--wrap-color-surface), $alpha: 0.9); 
			}
		}
		.modal-header {
			width: 100%;  
			background-color: inherit;
			border-top-left-radius: inherit;
			border-top-right-radius: inherit;
			padding-top: var(--upl-modal--header-padding-top);
			padding-inline: var(--upl-modal--padding);
			.modal-title {
				@include ellipsis(1);
				font-size: var(--upl-modal--header-pc-font-size);
				font-weight: var(--upl-font-weight-bold);  
			}
		}
		.modal-conts {
			@include flex-layout($fd: column);
			position: relative;
			overflow-y: auto;
			width: 100%;
			padding: var(--upl-modal--conts-padding-top) var(--upl-modal--padding) var(--upl-modal--conts-padding-bottom);
			@include scrollbar();
			> * {
				width: 100%;
			}
			.conts-area {
				@include flex-layout($fd: column);
				gap: var(--upl-modal--conts-gap);
				> * {
					width: 100%;
				}
			}
		}
		.modal-btn {
			@include flex-layout($ai: center, $jc: flex-end);
			gap: var(--upl-modal--btn-gap);
			padding: var(--upl-modal--btn-padding-top) var(--upl-modal--padding) var(--upl-modal--padding);
			.upl-btn {
				min-width: var(--upl-modal--btn-size-min-wdith);
			}
			&.multi-conts {
				justify-content: space-between;
			}
		}
		.btn-close {
			@include position($t: var(--upl-modal--btn-close-position), $r: var(--upl-modal--btn-close-position));
			z-index: 901;
		}
	}	

	//full 팝업(통합검색, 관련기관링크)
	&[data-type="full"] { 
		background-color: var(--upl-modal--full-popup-surface);
        .modal-dialog {
			width: 100%;
            height: 100%;
			margin: 0 auto;
			padding: 0;
        }
		.modal-header,
		.modal-conts {
			padding:0;
		}
        .modal-content {
            height: 100%;
			max-height: 100%;;
			background: none;
			margin: 0 auto;
			border: none;
			border-radius: 0;
        }
        .modal-back.in {
            display: none;
        }
    }

	//바텀시트(모바일만 사용)
    &[data-type="bottom-sheet"] {
		--upl-modal--bottom-sheet-radius: var(--upl-radius-xlarge1);
		--upl-modal--bottom-sheet-padding: var(--upl-padding-6);
		--upl-modal--bottom-sheet-btn-close-position-top: var(--upl-gap-6);
		--upl-modal--bottom-sheet-btn-close-position-right: var(--upl-gap-5);
		--upl-modal--bottom-sheet-btn-padding-top: var(--upl-padding-10);

        .modal-content {
            position: fixed;
            left: 0;
            bottom: -100%;
            border-radius: 0;
            border-top-left-radius: var(--upl-modal--bottom-sheet-radius);
            border-top-right-radius: var(--upl-modal--bottom-sheet-radius);
            max-height: 90%;
            transition: var(--upl-transition-base);
        }
        .modal-header {
            @include flex-layout($ai: center, $jc: space-between);
           	padding: var(--upl-modal--bottom-sheet-padding);
			flex-shrink: 0;
            .modal-title {
                font-size: var(--upl-pc-font-size-heading-small);
            }
        }
        .modal-conts {
            display: block;
            padding: 0 var(--upl-modal--bottom-sheet-padding);
            @include scrollbar;
        }
        .btn-close {
			top: var(--upl-modal--bottom-sheet-btn-close-position-top);
			right: var(--upl-modal--bottom-sheet-btn-close-position-right);
        }
        .pop-filter-top {
            width: auto;
        }
        .modal-btn {
			&.btn-wrap {
				padding: var(--upl-modal--bottom-sheet-btn-padding-top) var(--upl-modal--bottom-sheet-padding) var(--upl-modal--bottom-sheet-padding);
				.upl-btn {
					flex: 1;
				}
			}
        }
        &.in {
			.modal-content {
				bottom: 0;
			}
		}
    }
}

/* mobile */
@include size-medium {
	.upl-modal {
		&:not([data-type="bottom-sheet"]){
			//기본 스타일(bottom-sheet제외) 
			.modal-dialog { 
				width: var(--upl-modal--mobile-width);
				height: var(--upl-modal--mobile-height);
				min-height: var(--upl-modal--mobile-height);
				margin: var(--upl-modal--mobile-gap) auto;
				.modal-header {
					padding: var(--upl-modal--mobile-header-padding-top) var(--upl-modal--mobile-padding) 0;
					.modal-title {
						font-size: var(--upl-modal--header-mobile-font-size);
					}
				}
				.modal-content {
					max-height: 100%;
				}
				.modal-conts {
					padding-inline: var(--upl-modal--mobile-padding);
					padding-bottom: 0;
					.conts-area {
						> * {
							width: 100%;
						}
					}
				}
				.modal-btn {
					padding: var(--upl-modal--mobile-btn-padding-top) var(--upl-modal--mobile-padding) var(--upl-modal--mobile-btn-padding-bottom);
					
				}
				.btn-close {
					top: var(--upl-modal--mobile-btn-close-position);
					right: var(--upl-modal--mobile-btn-close-position);
				}
			}
		}

		//풀팝업
		&[data-type="full"] { 
			--upl-modal--full-mobile-btn-close-size: var(--upl-size-height-4);

			.modal-dialog {
				width: 100%;
				height: 100%;
				margin:0 auto;
				.btn-close {
					@include square(var(--upl-modal--full-mobile-btn-close-size));
				}
			}
		}
	}
}

//고대비모드
@include color-mode($mode: dark) {
	//모드 설정
	$mode-setting: dark;
	.upl-modal {
		@include modal-color-variable(#{$mode-setting});
		.modal-dialog {
			.modal-conts {
				@include scrollbar(#{$mode-setting});
			}
		}
	}
}