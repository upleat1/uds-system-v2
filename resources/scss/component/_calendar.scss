/* 달력 */
//사이즈 정의
@mixin calendar-size-variable() {
	--upl-calendar--radius: var(--upl-radius-xlarge2);
	--upl-calendar--head-pc-font-size: var(--upl-pc-font-size-heading-xsmall);
	--upl-calendar--head-mobile-font-size: var(--upl-mobile-font-size-heading-xsmall);
	--upl-calendar--head-btn-cal-switch-pc-font-size: var(--upl-pc-font-size-label-medium);
	--upl-calendar--head-btn-cal-switch-mobile-font-size: var(--upl-mobile-font-size-label-medium);
	--upl-calendar--head-btn-cal-switch-radius: var(--upl-radius-medium1);
	--upl-calendar--head-btn-cal-move-size: var(--upl-size-height-5);
	--upl-calendar--table-wrap-padding: var(--upl-gap-5);
	--upl-calendar--table-head-pc-font-size: var(--upl-pc-font-size-label-small);
	--upl-calendar--table-head-mobile-font-size: var(--upl-mobile-font-size-label-small);
	--upl-calendar--table-caption-pc-font-size: var(--upl-pc-font-size-heading-xxsmall);
	--upl-calendar--table-caption-mobile-font-size: var(--upl-pc-font-size-heading-xxsmall);
	--upl-calendar--set-date-radius: var(--upl-radius-max);
}

//컬러 정의
@mixin calendar-color-variable($mode: light) {
	--upl-calendar--color-border: var(--upl-#{$mode}-color-border-secondary-light);
	--upl-calendar--color-surface: var(--upl-#{$mode}-color-surface-secondary-subtler);
	--upl-calendar--color-text-sub: var(--upl-#{$mode}-color-text-subtle);
	--upl-calendar--head-btn-cal-move-color-text-active: var(--upl-#{$mode}-color-text-secondary);
	--upl-calendar--head-btn-cal-move-color-border: var(--upl-#{$mode}-color-border-gray-light);
	--upl-calendar--head-btn-cal-move-color-border-active: var(--upl-#{$mode}-color-border-secondary);
	--upl-calendar--head-btn-cal-move-color-action: var(--upl-#{$mode}-color-action-white);
	--upl-calendar--head-btn-cal-switch-color-action-hover: var(--upl-#{$mode}-color-action-secondary-hover);
	--upl-calendar--head-btn-cal-switch-color-action-active: var(--upl-#{$mode}-color-action-secondary-pressed);
	--upl-calendar--head-btn-cal-switch-color-text-disabled: var(--upl-#{$mode}-color-text-disabled-on);
	--upl-calendar--head-drop-down-shadow: 0 0 0.2rem 0 var(--upl-#{$mode}-color-alpha-shadow1), 0 0.4rem 0.8rem 0 var(--upl-#{$mode}-color-alpha-shadow2);
	--upl-calendar--date-set-color-action: var(--upl-#{$mode}-color-action-secondary-active);
	--upl-calendar--date-set-color-text: var(--upl-#{$mode}-color-text-inverse-static);
	--upl-calendar--date-set-color-text-day-off: var(--upl-#{$mode}-color-text-danger);
	--upl-calendar--date-set-color-text-day-event: var(--upl-#{$mode}-color-text-information);
	--upl-calendar--date-set-color-text-disabled: var(--upl-#{$mode}-color-text-disabled);
	--upl-calendar--date-set-color-action-pressed: var(--upl-#{$mode}-color-action-secondary-on-pressed);
	--upl-calendar--date-set-color-action-period: var(--upl-#{$mode}-color-action-secondary-on-selected);
	--upl-calendar--date-set-color-element-today: var(--upl-#{$mode}-color-element-point);
	--upl-calendar--action-btn-wrap-color-border: var(--upl-#{$mode}-color-divider-gray-light);
	--upl-calendar--action-btn-wrap-color-surface: var(--upl-#{$mode}-color-surface-white);
}

//모드 설정
$mode-setting: light;
// upl-calendar-area
.upl-calendar-area {
	@include calendar-size-variable();
	@include calendar-color-variable(#{$mode-setting});
	
	display: none;
	position: relative;
	z-index: 1000;
	width: 100%;
	.calendar-wrap {
		@include position($t: .8rem, $l: 0);
		width: 38.4rem;
		background-color: var(--upl-calendar--color-surface);
		border: 1px solid var(--upl-calendar--color-border);
		border-radius: var(--upl-calendar--radius);
		overflow: hidden;
		&.bottom {
			top: auto;  
			bottom: 6.4rem;
		}
		.calendar-head {
			@include flex-layout($ai: center, $jc: space-between);
			padding: var(--upl-padding-8);
			font-size: var(--upl-calendar--head-pc-font-size);
			font-weight: var(--upl-font-weight-bold);
			gap: var(--upl-gap-5);
			.btn-cal-move {
				@include flex-layout($ai: center, $jc: center);
				@include square(var(--upl-calendar--head-btn-cal-move-size));
				background-color: var(--upl-calendar--head-btn-cal-move-color-action);
				border: 1px solid var(--upl-calendar--head-btn-cal-move-color-border);
				border-radius: var(--upl-radius-max);
				flex-shrink: 0;
				&::before {
					@include pseudo();
					@include svg-icon(var(--upl-size-height-3), $mode: #{$mode-setting});
					@include icon-set(ico_angle);
					transform: rotate(90deg); 
				}
				&.next {
					&::before {
						transform: rotate(-90deg); 
					}
				}
			}
			.calendar-switch-wrap {
				@include flex-layout($ai: center, $jc: center);
				gap: var(--upl-gap-2);
				.btn-cal-switch {
					@include flex-layout($ai: center, $jc: center);
					gap: var(--upl-gap-2);
					height: var(--upl-size-height-6);
					border-radius: var(--upl-calendar--head-btn-cal-switch-radius);
					padding: 0 var(--upl-padding-3);
					transition: var(--upl-transition-base);
					&::after {
						@include pseudo();
						@include svg-icon(var(--upl-icon--size-small), $mode: #{$mode-setting});
						@include icon-set(ico_arrow_dropdown);
					}
					&:hover {
						background-color: var(--upl-calendar--head-btn-cal-switch-color-action-hover);
					}
					&:focus,
					&:active,
					&.active {
						background-color: var(--upl-calendar--head-btn-cal-switch-color-action-active);
					}
					&:disabled {
						cursor: default;
						color: var(--upl-calendar--head-btn-cal-switch-color-text-disabled);
						background-color: var(--upl-calendar--action-btn-wrap-color-surface);
						&::after {
							background-color: var(--upl-calendar--head-btn-cal-switch-color-text-disabled);
						}
					}
				}
				.calendar-drop-down {
					--upl-calendar-drop-down-btn-height: var(--upl-size-height-6);

					position: relative;
					.calendar-select {
						@include visibility(hidden);
						@include position($t:calc(100% + .4rem), $l: 0);
						@include position-center(x);
						overflow-x: hidden;
						overflow-y: auto;
						min-width: 14rem;
						max-height: calc((var(--upl-calendar-drop-down-btn-height) * 6) + (var(--upl-padding-3) * 2));
						border: 1px solid var(--upl-calendar--action-btn-wrap-color-border);
						background-color: var(--upl-calendar--action-btn-wrap-color-surface);
						border-radius: var(--upl-radius-medium4);
						padding: var(--upl-padding-3);
						transition: var(--upl-transition-base);
						box-shadow: var(--upl-calendar--head-drop-down-shadow);
						&.active {
							@include visibility(visible);
							z-index: 10;
						}
						.sel {
							@include flex-layout($fd: column);
							& li {
								width: 100%;
							}
							button {
								@include flex-layout($jc: center, $ai: center);
								@include square(100%, var(--upl-calendar-drop-down-btn-height));
								border-radius: var(--upl-radius-medium1);
								font-size: var(--upl-calendar--head-btn-cal-switch-pc-font-size);
								font-weight: var(--upl-font-weight-regular);
								&:hover {
									background-color: var(--upl-calendar--head-btn-cal-switch-color-action-hover);
								}
								&:focus,
								&:active {
									background-color: var(--upl-calendar--head-btn-cal-switch-color-action-active);
								}
								&.active {
									color: var(--upl-calendar--head-btn-cal-move-color-text-active);
									border: 1px solid var(--upl-calendar--head-btn-cal-move-color-border-active);
									background-color: var(--upl-calendar--action-btn-wrap-color-surface);
								}
								&:disabled {
									cursor: default;
									color: var(--upl-calendar--head-btn-cal-switch-color-text-disabled);
									background-color: var(--upl-calendar--action-btn-wrap-color-surface);
								}
							}
						}
					}
				}
			}
		}
		.calendar-body {
			position: relative;
			.calendar-table-wrap {
				padding: 0 var(--upl-calendar--table-wrap-padding);
				.calendar-tbl {
					caption {
						width: auto !important;
						height: auto !important;
						margin: 0 !important;
						clip: auto !important;
						text-align: left;
						top: 4.6rem;
						left: var(--upl-calendar--table-wrap-padding);
						color: var(--upl-calendar--color-text-sub);
						font-weight: var(--upl-font-weight-bold);
						font-size: var(--upl-calendar--table-caption-pc-font-size);
					}
					th,
					td {
						width: calc(100% / 7);
					}
					th {
						padding-bottom: 4.6rem;
						font-weight: var(--upl-font-weight-regular);
						font-size: var(--upl-calendar--table-head-pc-font-size);
					}
					td {
						padding: var(--upl-padding-1) 0;
						> button {
							@include flex-layout($ai: center, $jc: center);
							@include square(100%);
							position: relative;
							width:44px;
							height:44px;
							margin-inline:auto;
							& span {
								z-index: 1;
							}
							&::after {
								@include position($t: 0, $l: 0);
								@include pseudo();
								@include square(100%);
								border-radius: var(--upl-calendar--set-date-radius);
								transition: var(--upl-transition-base);
							}
						}
						.btn-set-date:focus {
							z-index: 1;
						}
						&:not(.period, .old, .new, .disabled) .btn-set-date:hover {
							&::after {
								background-color: var(--upl-calendar--date-set-color-action-period);
							}
						}
						&:not(.period, .old, .new, .disabled) .btn-set-date:focus,
						&:not(.period, .old, .new, .disabled) .btn-set-date:active {
							&::after {
								background-color: var(--upl-calendar--date-set-color-action-pressed);
							}
						}
						&.today {
							.btn-set-date {
								span {
									position: relative;
									&::before {
										@include pseudo();
										@include square(.4rem);
										@include position($b: -10%);
										@include position-center(x);
										border-radius: var(--upl-radius-max);
										background-color: var(--upl-calendar--date-set-color-element-today);
									}
								}
							}
						}
						&.day-event {
							.btn-set-date {
								color: var(--upl-calendar--date-set-color-text-day-event);
								span {
									position: relative;
									@include underline(0.2rem);
									&::before {
										@include position($b: -38%);
										@include position-center(x);
										content: "이벤트";
										font-size: 1rem;
										font-weight: var(--upl-font-weight-bold);
									}
								}
							}
						}
						&.day-off { 
							color: var(--upl-calendar--date-set-color-text-day-off);
						}
						&.old,
						&.new, 
						&.disabled {
							color: var(--upl-calendar--date-set-color-text-disabled);
							& button {
								cursor: default;
							}
						}
						&.period {
							.btn-set-date {
								background-color: var(--upl-calendar--date-set-color-action-period);
							}
							&.start,
							&.end {
								> .btn-set-date {
									background-color: var(--upl-calendar--date-set-color-action);
									color: var(--upl-calendar--date-set-color-text);
								}
							}
							&.start {
								> .btn-set-date {
									border-top-left-radius: var(--upl-calendar--set-date-radius);
									border-bottom-left-radius: var(--upl-calendar--set-date-radius);
								}
							}
							&.end {
								> .btn-set-date {
									border-top-right-radius: var(--upl-calendar--set-date-radius);
									border-bottom-right-radius: var(--upl-calendar--set-date-radius);
								}
							}
						}
					}
				}
			}
		}
		.calendar-footer {
			margin-top: var(--upl-calendar--table-wrap-padding);
			.calendar-btn-wrap {
				@include flex-layout($jc: flex-end, $ai: center);
				gap: var(--upl-gap-3);
				padding: var(--upl-padding-6) var(--upl-padding-8);
				border-top: 1px solid var(--upl-calendar--action-btn-wrap-color-border);
				background-color: var(--upl-calendar--action-btn-wrap-color-surface);
				& .upl-btn:first-child {
					margin-right: auto;
				}
			}
		}	
		&:not(.single) {
			.calendar-body {
				.calendar-table-wrap {
					.calendar-tbl {
						--upl-calendar--after-size: calc(100% - var(--upl-padding-1) * 2);
						td {
							position: relative;
							&::after {
								@include position($t: 50%, $l: 0);
								@include pseudo();
								@include square(100%, var(--upl-calendar--after-size));
								transform: translateY(-50%);
							}
						}
						td.period {
							&::after {
								background-color: var(--upl-calendar--date-set-color-action-period);
							}
						}
						td.start {
							&::after {
								background-color: var(--upl-calendar--date-set-color-action);
								border-top-left-radius: var(--upl-calendar--set-date-radius);
								border-bottom-left-radius: var(--upl-calendar--set-date-radius);
								@include square(var(--upl-calendar--after-size), var(--upl-calendar--after-size));
								right: 0;
								left: unset;
							}
						}
						td.end {
							&::after {
								background-color: var(--upl-calendar--date-set-color-action);
								border-top-right-radius: var(--upl-calendar--set-date-radius);
								border-bottom-right-radius: var(--upl-calendar--set-date-radius);
								@include square(var(--upl-calendar--after-size), var(--upl-calendar--after-size));
							}
						}
						td.period.start.end {
							&::after {
								display: none;
							}
						}
					}
				}
			}
		}
	}
	&.active {
		display: block;
	}
}

//고대비모드
@include color-mode($mode: dark) {
	//모드 설정
	$mode-setting: dark;

	// upl-calendar-area
	.upl-calendar-area {
		@include calendar-color-variable(#{$mode-setting});

		.calendar-wrap {
			.calendar-head {
				.btn-cal-move {
					&::before {
						@include svg-icon(var(--upl-size-height-3), $mode: #{$mode-setting});
					}
				}
				.calendar-switch-wrap {
					.btn-cal-switch {
						&::after {
							@include svg-icon(var(--upl-icon--size-small),  $mode: #{$mode-setting});
						}
					}
				}
			}
		}
	}
}




@include size-large-more {
	.calendar-select {
		@include scrollbar;
	}
}

@media (max-width: 440px) {
	.upl-calendar-area {
		.calendar-wrap {
			$w: calc(100vw - (var(--upl-contents-padding-x) * 2));
			left: calc(50% - ($w / 2));
			width: $w;
		}
	}
}